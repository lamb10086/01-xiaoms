{"ast":null,"code":"import { watch, onBeforeUnmount, onDeactivated } from \"vue\";\nimport { getScrollParent, onMountedOrActivated } from \"@vant/use\";\nimport { useTouch } from \"./use-touch.mjs\";\nimport { preventDefault } from \"../utils/index.mjs\";\nlet totalLockCount = 0;\nconst BODY_LOCK_CLASS = \"van-overflow-hidden\";\nfunction useLockScroll(rootRef, shouldLock) {\n  const touch = useTouch();\n  const DIRECTION_UP = \"01\";\n  const DIRECTION_DOWN = \"10\";\n  const onTouchMove = event => {\n    touch.move(event);\n    const direction = touch.deltaY.value > 0 ? DIRECTION_DOWN : DIRECTION_UP;\n    const el = getScrollParent(event.target, rootRef.value);\n    const {\n      scrollHeight,\n      offsetHeight,\n      scrollTop\n    } = el;\n    let status = \"11\";\n    if (scrollTop === 0) {\n      status = offsetHeight >= scrollHeight ? \"00\" : \"01\";\n    } else if (scrollTop + offsetHeight >= scrollHeight) {\n      status = \"10\";\n    }\n    if (status !== \"11\" && touch.isVertical() && !(parseInt(status, 2) & parseInt(direction, 2))) {\n      preventDefault(event, true);\n    }\n  };\n  const lock = () => {\n    document.addEventListener(\"touchstart\", touch.start);\n    document.addEventListener(\"touchmove\", onTouchMove, {\n      passive: false\n    });\n    if (!totalLockCount) {\n      document.body.classList.add(BODY_LOCK_CLASS);\n    }\n    totalLockCount++;\n  };\n  const unlock = () => {\n    if (totalLockCount) {\n      document.removeEventListener(\"touchstart\", touch.start);\n      document.removeEventListener(\"touchmove\", onTouchMove);\n      totalLockCount--;\n      if (!totalLockCount) {\n        document.body.classList.remove(BODY_LOCK_CLASS);\n      }\n    }\n  };\n  const init = () => shouldLock() && lock();\n  const destroy = () => shouldLock() && unlock();\n  onMountedOrActivated(init);\n  onDeactivated(destroy);\n  onBeforeUnmount(destroy);\n  watch(shouldLock, value => {\n    value ? lock() : unlock();\n  });\n}\nexport { useLockScroll };","map":{"version":3,"names":["watch","onBeforeUnmount","onDeactivated","getScrollParent","onMountedOrActivated","useTouch","preventDefault","totalLockCount","BODY_LOCK_CLASS","useLockScroll","rootRef","shouldLock","touch","DIRECTION_UP","DIRECTION_DOWN","onTouchMove","event","move","direction","deltaY","value","el","target","scrollHeight","offsetHeight","scrollTop","status","isVertical","parseInt","lock","document","addEventListener","start","passive","body","classList","add","unlock","removeEventListener","remove","init","destroy"],"sources":["C:/Users/yangp/Desktop/01-xiaoms/node_modules/vant/es/composables/use-lock-scroll.mjs"],"sourcesContent":["import { watch, onBeforeUnmount, onDeactivated } from \"vue\";\r\nimport { getScrollParent, onMountedOrActivated } from \"@vant/use\";\r\nimport { useTouch } from \"./use-touch.mjs\";\r\nimport { preventDefault } from \"../utils/index.mjs\";\r\nlet totalLockCount = 0;\r\nconst BODY_LOCK_CLASS = \"van-overflow-hidden\";\r\nfunction useLockScroll(rootRef, shouldLock) {\r\n  const touch = useTouch();\r\n  const DIRECTION_UP = \"01\";\r\n  const DIRECTION_DOWN = \"10\";\r\n  const onTouchMove = (event) => {\r\n    touch.move(event);\r\n    const direction = touch.deltaY.value > 0 ? DIRECTION_DOWN : DIRECTION_UP;\r\n    const el = getScrollParent(\r\n      event.target,\r\n      rootRef.value\r\n    );\r\n    const { scrollHeight, offsetHeight, scrollTop } = el;\r\n    let status = \"11\";\r\n    if (scrollTop === 0) {\r\n      status = offsetHeight >= scrollHeight ? \"00\" : \"01\";\r\n    } else if (scrollTop + offsetHeight >= scrollHeight) {\r\n      status = \"10\";\r\n    }\r\n    if (status !== \"11\" && touch.isVertical() && !(parseInt(status, 2) & parseInt(direction, 2))) {\r\n      preventDefault(event, true);\r\n    }\r\n  };\r\n  const lock = () => {\r\n    document.addEventListener(\"touchstart\", touch.start);\r\n    document.addEventListener(\"touchmove\", onTouchMove, { passive: false });\r\n    if (!totalLockCount) {\r\n      document.body.classList.add(BODY_LOCK_CLASS);\r\n    }\r\n    totalLockCount++;\r\n  };\r\n  const unlock = () => {\r\n    if (totalLockCount) {\r\n      document.removeEventListener(\"touchstart\", touch.start);\r\n      document.removeEventListener(\"touchmove\", onTouchMove);\r\n      totalLockCount--;\r\n      if (!totalLockCount) {\r\n        document.body.classList.remove(BODY_LOCK_CLASS);\r\n      }\r\n    }\r\n  };\r\n  const init = () => shouldLock() && lock();\r\n  const destroy = () => shouldLock() && unlock();\r\n  onMountedOrActivated(init);\r\n  onDeactivated(destroy);\r\n  onBeforeUnmount(destroy);\r\n  watch(shouldLock, (value) => {\r\n    value ? lock() : unlock();\r\n  });\r\n}\r\nexport {\r\n  useLockScroll\r\n};\r\n"],"mappings":"AAAA,SAASA,KAAK,EAAEC,eAAe,EAAEC,aAAa,QAAQ,KAAK;AAC3D,SAASC,eAAe,EAAEC,oBAAoB,QAAQ,WAAW;AACjE,SAASC,QAAQ,QAAQ,iBAAiB;AAC1C,SAASC,cAAc,QAAQ,oBAAoB;AACnD,IAAIC,cAAc,GAAG,CAAC;AACtB,MAAMC,eAAe,GAAG,qBAAqB;AAC7C,SAASC,aAAa,CAACC,OAAO,EAAEC,UAAU,EAAE;EAC1C,MAAMC,KAAK,GAAGP,QAAQ,EAAE;EACxB,MAAMQ,YAAY,GAAG,IAAI;EACzB,MAAMC,cAAc,GAAG,IAAI;EAC3B,MAAMC,WAAW,GAAIC,KAAK,IAAK;IAC7BJ,KAAK,CAACK,IAAI,CAACD,KAAK,CAAC;IACjB,MAAME,SAAS,GAAGN,KAAK,CAACO,MAAM,CAACC,KAAK,GAAG,CAAC,GAAGN,cAAc,GAAGD,YAAY;IACxE,MAAMQ,EAAE,GAAGlB,eAAe,CACxBa,KAAK,CAACM,MAAM,EACZZ,OAAO,CAACU,KAAK,CACd;IACD,MAAM;MAAEG,YAAY;MAAEC,YAAY;MAAEC;IAAU,CAAC,GAAGJ,EAAE;IACpD,IAAIK,MAAM,GAAG,IAAI;IACjB,IAAID,SAAS,KAAK,CAAC,EAAE;MACnBC,MAAM,GAAGF,YAAY,IAAID,YAAY,GAAG,IAAI,GAAG,IAAI;IACrD,CAAC,MAAM,IAAIE,SAAS,GAAGD,YAAY,IAAID,YAAY,EAAE;MACnDG,MAAM,GAAG,IAAI;IACf;IACA,IAAIA,MAAM,KAAK,IAAI,IAAId,KAAK,CAACe,UAAU,EAAE,IAAI,EAAEC,QAAQ,CAACF,MAAM,EAAE,CAAC,CAAC,GAAGE,QAAQ,CAACV,SAAS,EAAE,CAAC,CAAC,CAAC,EAAE;MAC5FZ,cAAc,CAACU,KAAK,EAAE,IAAI,CAAC;IAC7B;EACF,CAAC;EACD,MAAMa,IAAI,GAAG,MAAM;IACjBC,QAAQ,CAACC,gBAAgB,CAAC,YAAY,EAAEnB,KAAK,CAACoB,KAAK,CAAC;IACpDF,QAAQ,CAACC,gBAAgB,CAAC,WAAW,EAAEhB,WAAW,EAAE;MAAEkB,OAAO,EAAE;IAAM,CAAC,CAAC;IACvE,IAAI,CAAC1B,cAAc,EAAE;MACnBuB,QAAQ,CAACI,IAAI,CAACC,SAAS,CAACC,GAAG,CAAC5B,eAAe,CAAC;IAC9C;IACAD,cAAc,EAAE;EAClB,CAAC;EACD,MAAM8B,MAAM,GAAG,MAAM;IACnB,IAAI9B,cAAc,EAAE;MAClBuB,QAAQ,CAACQ,mBAAmB,CAAC,YAAY,EAAE1B,KAAK,CAACoB,KAAK,CAAC;MACvDF,QAAQ,CAACQ,mBAAmB,CAAC,WAAW,EAAEvB,WAAW,CAAC;MACtDR,cAAc,EAAE;MAChB,IAAI,CAACA,cAAc,EAAE;QACnBuB,QAAQ,CAACI,IAAI,CAACC,SAAS,CAACI,MAAM,CAAC/B,eAAe,CAAC;MACjD;IACF;EACF,CAAC;EACD,MAAMgC,IAAI,GAAG,MAAM7B,UAAU,EAAE,IAAIkB,IAAI,EAAE;EACzC,MAAMY,OAAO,GAAG,MAAM9B,UAAU,EAAE,IAAI0B,MAAM,EAAE;EAC9CjC,oBAAoB,CAACoC,IAAI,CAAC;EAC1BtC,aAAa,CAACuC,OAAO,CAAC;EACtBxC,eAAe,CAACwC,OAAO,CAAC;EACxBzC,KAAK,CAACW,UAAU,EAAGS,KAAK,IAAK;IAC3BA,KAAK,GAAGS,IAAI,EAAE,GAAGQ,MAAM,EAAE;EAC3B,CAAC,CAAC;AACJ;AACA,SACE5B,aAAa"},"metadata":{},"sourceType":"module"}