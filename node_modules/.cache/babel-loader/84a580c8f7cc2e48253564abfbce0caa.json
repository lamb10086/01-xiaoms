{"ast":null,"code":"import { getIlnessList, getUserPet, getpreviewList } from \"@/api/xiaomengshu\";\nimport DetailList from '../../../../components/xiaomengshu/Illness/DetailList.vue';\nimport IndexBar from \"../../../../components/xiaomengshu/Illness/IndexBar.vue\";\nimport { showFailToast } from 'vant';\nexport default {\n  components: {\n    DetailList,\n    IndexBar\n  },\n  data() {\n    return {\n      formIds: [],\n      formNo_ids: [],\n      date: [],\n      dateMap: new Map(),\n      pet_typeid: 0,\n      cidArray: [],\n      topUrl: \"https://static.epetbar.com/epet_wap_img/tools/h_infohead.png\",\n      formList: [],\n      symptom: [],\n      pet_type: {},\n      pet_typeList: [],\n      showChoicepet_type: false,\n      showChoicepet_age: false,\n      ageTime: new Array(),\n      choiceCid: 0,\n      detailList: [],\n      ids: [],\n      no_ids: [],\n      themeVars: {\n        radioLabelColor: '#c8c9cc',\n        buttonNormalFontSize: '1.2rem'\n      },\n      isFirst: true,\n      againDetail: [],\n      againDetailNum: -2,\n      showPreview: false,\n      previewList: [],\n      getAll: 0,\n      cidList: []\n    };\n  },\n  provide() {\n    return {\n      ids: this.ids,\n      no_ids: this.no_ids\n    };\n  },\n  async created() {\n    this.pet_typeid = this.$store.state.pet_typeid;\n    await this.getList(0);\n    this.date.forEach(item => {\n      this.dateMap.set(item.cid, item.title);\n    });\n    const {\n      cids: cidArray\n    } = this.$route.query;\n    this.cidArray = cidArray.split(\",\");\n    await this.getFormList();\n    await this.getSySmptomList();\n    this.ageTime = [];\n  },\n  computed: {\n    ageString() {\n      return String(this.ageTime).replaceAll(',', '-');\n    }\n  },\n  methods: {\n    async getList(site) {\n      let res = await getIlnessList({\n        do: \"DepartmentList\",\n        site: site + 1\n      });\n      //   console.log(res);\n      this.date = [];\n      res.data.forEach(element => {\n        if (element.relate_basic_cid.length) {\n          //   console.log(element.title);\n          this.date.push(element);\n        }\n      });\n      this.pet_typeid = site;\n      //   this.date.pop();\n    },\n\n    //获取form表单\n    async getFormList() {\n      let res = await getIlnessList({\n        do: \"BasicSituateList\",\n        cids: String(this.cidArray)\n      });\n      this.formList = res.data;\n      console.log(this.formList);\n    },\n    outpet_type() {\n      console.log(this.pet_type);\n    },\n    //获取症状列表\n    async getSySmptomList() {\n      let res = await getIlnessList({\n        do: \"DepartmentSonList\",\n        cids: String(this.cidArray)\n      });\n      this.symptom = res.data;\n    },\n    //获取详情列表\n    async getDetailList() {\n      let res = await getIlnessList({\n        do: \"SymptomList\",\n        cid: this.choiceCid\n      });\n      this.detailList = res.data;\n      this.getAll += 1;\n    },\n    changeCid(cid) {\n      this.choiceCid = cid;\n      if (this.cidList.indexOf(cid) == -1) this.cidList.push(cid);\n      this.getDetailList();\n    },\n    //点击下一步\n    async nextResult() {\n      this.getAll += 1;\n      this.$nextTick(async () => {\n        console.log(111);\n        if (this.isFirst || this.againDetailNum == -1) {\n          let res = await getIlnessList({\n            do: \"result\",\n            ids: String([...this.formIds, ...this.ids]),\n            no_ids: String([...this.formNo_ids, ...this.no_ids]),\n            cid: String(this.cidList),\n            age: this.ageString,\n            pt_type: this.pet_type.id\n          });\n          if (res.data.is_result <= 1) {\n            this.$store.state.illnessresultList = res.data.result_list;\n            this.$router.push({\n              name: 'illnesspage',\n              query: {\n                type: res.data.is_result\n              }\n            });\n          } else if (this.isFirst) {\n            this.againDetail = res.data.symptom_list;\n            this.againDetailNum = res.data.symptom_list.length - 1;\n            this.isFirst = false;\n            this.detailList = this.againDetail[this.againDetailNum].combination;\n            this.againDetailNum--;\n          }\n        } else {\n          this.detailList = this.againDetail[this.againDetailNum].combination;\n          this.againDetailNum--;\n        }\n      });\n    },\n    async choicePet_type() {\n      this.showChoicepet_type = true;\n      let res = await getUserPet({\n        do: 'GetPettype'\n      });\n      this.pet_typeList = res.list;\n    },\n    choicePet_age() {\n      this.showChoicepet_age = true;\n    },\n    changeAge({\n      selectedValues\n    }) {\n      this.ageTime = selectedValues;\n      this.showChoicepet_age = false;\n    },\n    chageRadio(index, type, list) {\n      this.formIds[index] = list[type].cid;\n      this.formNo_ids[index] = list[type ^ 1].cid;\n    },\n    Preview() {\n      if (this.cidList.length == 0) {\n        showFailToast('请选择症状');\n        return;\n      }\n      this.getAll += 1;\n      this.$nextTick(async () => {\n        let res = await getpreviewList({\n          do: \"CheckList\",\n          ids: String(this.ids)\n        });\n        this.previewList = res.data;\n        this.showPreview = true;\n      });\n    }\n  }\n};","map":{"version":3,"mappings":"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","names":["getIlnessList","getUserPet","getpreviewList","DetailList","IndexBar","showFailToast","components","data","formIds","formNo_ids","date","dateMap","Map","pet_typeid","cidArray","topUrl","formList","symptom","pet_type","pet_typeList","showChoicepet_type","showChoicepet_age","ageTime","Array","choiceCid","detailList","ids","no_ids","themeVars","radioLabelColor","buttonNormalFontSize","isFirst","againDetail","againDetailNum","showPreview","previewList","getAll","cidList","provide","created","$store","state","getList","forEach","item","set","cid","title","cids","$route","query","split","getFormList","getSySmptomList","computed","ageString","String","replaceAll","methods","site","res","do","element","relate_basic_cid","length","push","console","log","outpet_type","getDetailList","changeCid","indexOf","nextResult","$nextTick","age","pt_type","id","is_result","illnessresultList","result_list","$router","name","type","symptom_list","combination","choicePet_type","list","choicePet_age","changeAge","selectedValues","chageRadio","index","Preview"],"sourceRoot":"","sources":["C:\\Code\\VScode\\VUE\\项目\\01-xiaoms\\src\\views\\xiaomengshu\\ToolView\\Illness\\IllnessForm.vue"],"sourcesContent":["<template>\r\n    <van-config-provider :theme-vars=\"themeVars\">\r\n        <div style=\"padding-bottom:60px;\">\r\n            <div class=\"top-img\">\r\n                <img :src=\"topUrl\" alt=\"\" />\r\n                <div class=\"top-reminder\">\r\n                    请选择{{ String(cidArray.map((item) => { return dateMap.get(item * 1) })) }}症状类型\r\n                </div>\r\n            </div>\r\n            <div class=\"main-form\" v-show=\"isFirst\">\r\n\r\n                <van-form @submit=\"onSubmit\" label-width=\"6rem\" input-align=\"right\">\r\n                    <van-cell-group inset>\r\n                        <h3>请填写基本信息</h3>\r\n                        <van-field v-if=\"this.$route.query.pet_typeid == 0\" @click=\"choicePet_type\" readonly\r\n                            v-model=\"pet_type.name\" label=\"宠物品种\" placeholder=\"请选择宠物品种\" />\r\n                        <template v-for=\"(item, index) in formList\" :key=\"item.title\">\r\n                            <van-field v-if=\"item.type === 1 && item.list.length != 0\" :label=\"item.title\">\r\n                                <template #input>\r\n                                    <div>\r\n                                        <van-radio-group v-model=\"formIds[index]\" direction=\"horizontal\"\r\n                                            icon-size=\"1.5rem\">\r\n                                            <van-radio :name=\"item.list[0].cid\"\r\n                                                @click=\"chageRadio(index, 0, item.list)\">{{ item.list[0].title\r\n                                                }}</van-radio>\r\n                                            <van-radio :name=\"item.list[1].cid\"\r\n                                                @click=\"chageRadio(index, 1, item.list)\">{{ item.list[1].title\r\n                                                }}</van-radio>\r\n                                        </van-radio-group>\r\n                                    </div>\r\n                                </template>\r\n                            </van-field>\r\n                            <van-field @click=\"choicePet_age\" v-if=\"item.type === 2\" readonly v-model=\"ageString\"\r\n                                :label=\"item.title\" placeholder=\"请选择宠物年龄\" />\r\n\r\n                        </template>\r\n\r\n\r\n                    </van-cell-group>\r\n                </van-form>\r\n                <div class=\"symptom-btn\">\r\n                    <van-button :class=\"{ choicebtn: item.cid === choiceCid }\" v-for=\"item in symptom\" :key=\"item.cid\"\r\n                        round type=\"default\" @click.prevent=\"changeCid(item.cid)\">{{\r\n                                item.title\r\n                        }}</van-button>\r\n                </div>\r\n            </div>\r\n            <detail-list :cid=\"choiceCid\" :detailList=\"detailList\" :getAll=\"getAll\"></detail-list>\r\n\r\n        </div>\r\n        <div class=\"botton-btn\">\r\n            <van-button round type=\"default\" @click=\"Preview()\" class=\"detailbutton\">预览病症</van-button>\r\n            <van-button round type=\"default\" @click=\"nextResult()\" class=\"nextbutton\">下一步</van-button>\r\n        </div>\r\n        <!-- 写dialog的div -->\r\n        <div>\r\n            <van-popup class=\"pet_typeClass\" v-model:show=\"showChoicepet_type\" position=\"bottom\" round\r\n                :style=\"{ height: '60%' }\">\r\n                <div class=\"top\">\r\n                    <h2>选择宠物品种</h2>\r\n                    <hr>\r\n                </div>\r\n\r\n                <div class=\"choice\">\r\n                    <index-bar v-model:isShow=\"showChoicepet_type\" v-model:bacObj=\"pet_type\"\r\n                        :choicelist=\"pet_typeList\"></index-bar>\r\n                </div>\r\n            </van-popup>\r\n            <van-popup class=\"ageClass\" v-model:show=\"showChoicepet_age\" position=\"bottom\" round\r\n                :style=\"{ height: '60%' }\">\r\n                <van-date-picker @cancel=\"this.showChoicepet_age = false\" @confirm=\"changeAge\" v-model=\"ageTime\"\r\n                    title=\"选择日期\" :max-date=\"new Date()\" />\r\n            </van-popup>\r\n            <!-- 显示预览 -->\r\n            <van-popup class=\"pet_typeClass\" v-model:show=\"showPreview\" position=\"bottom\" round\r\n                :style=\"{ height: '50%' }\">\r\n                <div class=\"top\">\r\n                    <h2>当前已选症状</h2>\r\n                    <hr>\r\n                </div>\r\n                <div>\r\n                    <div v-for=\"item in previewList\" :key=\"item.title\" class=\"preview-nav\">\r\n                        <b>{{ item.title }}:</b>\r\n                        <template v-if=\"item.is_img\">\r\n                            <img v-for=\"item2 in item.list\" :key=\"item2.cid\" :src=\"item2.img\" alt=\".\"\r\n                                class=\"preview-img\" />\r\n                        </template>\r\n                        <template v-else>\r\n                            <van-button size=\"small\" v-for=\"btn in item.list\" plain :key=\"btn.cid\" round\r\n                                style=\"margin:5px\" color=\"#30abb3\">{{\r\n                                        btn.title\r\n                                }}</van-button>\r\n                        </template>\r\n                    </div>\r\n                </div>\r\n                <van-button round type=\"default\" @click=\"showPreview = false\" class=\"cencelpreview\"\r\n                    color=\"#30abb3\">取消预览病症</van-button>\r\n            </van-popup>\r\n        </div>\r\n    </van-config-provider>\r\n\r\n</template>\r\n\r\n<script>\r\nimport { getIlnessList, getUserPet, getpreviewList } from \"@/api/xiaomengshu\"\r\nimport DetailList from '../../../../components/xiaomengshu/Illness/DetailList.vue';\r\nimport IndexBar from \"../../../../components/xiaomengshu/Illness/IndexBar.vue\"\r\nimport { showFailToast } from 'vant'\r\nexport default {\r\n    components: { DetailList, IndexBar },\r\n    data() {\r\n        return {\r\n            formIds: [],\r\n            formNo_ids: [],\r\n            date: [],\r\n            dateMap: new Map,\r\n            pet_typeid: 0,\r\n            cidArray: [],\r\n            topUrl: \"https://static.epetbar.com/epet_wap_img/tools/h_infohead.png\",\r\n            formList: [],\r\n            symptom: [],\r\n            pet_type: {},\r\n            pet_typeList: [],\r\n            showChoicepet_type: false,\r\n            showChoicepet_age: false,\r\n            ageTime: new Array,\r\n            choiceCid: 0,\r\n            detailList: [],\r\n            ids: [],\r\n            no_ids: [],\r\n            themeVars: {\r\n                radioLabelColor: '#c8c9cc',\r\n                buttonNormalFontSize: '1.2rem'\r\n            },\r\n            isFirst: true,\r\n            againDetail: [],\r\n            againDetailNum: -2,\r\n            showPreview: false,\r\n            previewList: [],\r\n            getAll: 0,\r\n            cidList: []\r\n        }\r\n    },\r\n    provide() {\r\n        return {\r\n            ids: this.ids,\r\n            no_ids: this.no_ids\r\n        }\r\n\r\n    },\r\n\r\n    async created() {\r\n        this.pet_typeid = this.$store.state.pet_typeid;\r\n        await this.getList(0);\r\n        this.date.forEach((item) => {\r\n            this.dateMap.set(item.cid, item.title);\r\n        })\r\n        const { cids: cidArray } = this.$route.query;\r\n\r\n        this.cidArray = cidArray.split(\",\");\r\n        await this.getFormList();\r\n        await this.getSySmptomList();\r\n        this.ageTime = [];\r\n\r\n    },\r\n    computed: {\r\n        ageString() {\r\n            return String(this.ageTime).replaceAll(',', '-');\r\n        }\r\n    },\r\n    methods: {\r\n        async getList(site) {\r\n            let res = await getIlnessList({\r\n                do: \"DepartmentList\",\r\n                site: site + 1,\r\n            });\r\n            //   console.log(res);\r\n            this.date = [];\r\n            res.data.forEach((element) => {\r\n                if (element.relate_basic_cid.length) {\r\n                    //   console.log(element.title);\r\n                    this.date.push(element);\r\n                }\r\n            });\r\n            this.pet_typeid = site;\r\n            //   this.date.pop();\r\n        },\r\n        //获取form表单\r\n        async getFormList() {\r\n            let res = await getIlnessList({\r\n                do: \"BasicSituateList\",\r\n                cids: String(this.cidArray),\r\n            });\r\n            this.formList = res.data;\r\n            console.log(this.formList)\r\n        },\r\n        outpet_type() {\r\n            console.log(this.pet_type)\r\n        },\r\n        //获取症状列表\r\n        async getSySmptomList() {\r\n            let res = await getIlnessList({\r\n                do: \"DepartmentSonList\",\r\n                cids: String(this.cidArray),\r\n            });\r\n            this.symptom = res.data;\r\n        },\r\n        //获取详情列表\r\n        async getDetailList() {\r\n            let res = await getIlnessList({\r\n                do: \"SymptomList\",\r\n                cid: this.choiceCid,\r\n            });\r\n            this.detailList = res.data;\r\n            this.getAll += 1;\r\n\r\n        },\r\n        changeCid(cid) {\r\n            this.choiceCid = cid;\r\n            if (this.cidList.indexOf(cid) == -1)\r\n                this.cidList.push(cid);\r\n            this.getDetailList();\r\n        },\r\n        //点击下一步\r\n        async nextResult() {\r\n            this.getAll += 1;\r\n            this.$nextTick(async () => {\r\n                console.log(111)\r\n                if (this.isFirst || this.againDetailNum == -1) {\r\n                    let res = await getIlnessList({\r\n                        do: \"result\",\r\n                        ids: String([...this.formIds, ...this.ids]),\r\n                        no_ids: String([...this.formNo_ids, ...this.no_ids]),\r\n                        cid: String(this.cidList),\r\n                        age: this.ageString,\r\n                        pt_type: this.pet_type.id,\r\n                    });\r\n                    if (res.data.is_result <= 1) {\r\n                        this.$store.state.illnessresultList = res.data.result_list;\r\n                        this.$router.push({\r\n                            name: 'illnesspage',\r\n                            query: {\r\n                                type: res.data.is_result,\r\n                            }\r\n                        })\r\n                    }\r\n                    else if (this.isFirst) {\r\n                        this.againDetail = res.data.symptom_list\r\n                        this.againDetailNum = res.data.symptom_list.length - 1;\r\n                        this.isFirst = false;\r\n                        this.detailList = this.againDetail[this.againDetailNum].combination;\r\n                        this.againDetailNum--;\r\n                    }\r\n                }\r\n                else {\r\n                    this.detailList = this.againDetail[this.againDetailNum].combination;\r\n                    this.againDetailNum--;\r\n                }\r\n            })\r\n\r\n\r\n        },\r\n        async choicePet_type() {\r\n            this.showChoicepet_type = true;\r\n            let res = await getUserPet({ do: 'GetPettype' });\r\n            this.pet_typeList = res.list;\r\n        },\r\n        choicePet_age() {\r\n            this.showChoicepet_age = true;\r\n        },\r\n        changeAge({ selectedValues }) {\r\n            this.ageTime = selectedValues\r\n            this.showChoicepet_age = false\r\n        },\r\n        chageRadio(index, type, list) {\r\n            this.formIds[index] = list[type].cid;\r\n            this.formNo_ids[index] = list[type ^ 1].cid;\r\n        },\r\n        Preview() {\r\n            if (this.cidList.length == 0) {\r\n                showFailToast('请选择症状');\r\n                return;\r\n            }\r\n            this.getAll += 1;\r\n            this.$nextTick(async () => {\r\n                let res = await getpreviewList({\r\n                    do: \"CheckList\",\r\n                    ids: String(this.ids)\r\n                });\r\n                this.previewList = res.data;\r\n                this.showPreview = true;\r\n            })\r\n        }\r\n    }\r\n\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.top-img {\r\n    width: 100%;\r\n    position: relative;\r\n\r\n    &>img {\r\n        width: 100%;\r\n    }\r\n\r\n    .top-reminder {\r\n\r\n        font-size: 1.3rem;\r\n        font-weight: 600;\r\n        position: absolute;\r\n        top: 20%;\r\n        left: 25%;\r\n        padding: 2rem;\r\n        background-size: 100% 100%;\r\n        background-image: url(@/assets/xiaomengshu/illnessreminder.png);\r\n    }\r\n}\r\n\r\n.main-form {\r\n    font-size: 1.2rem;\r\n\r\n    .van-cell {\r\n        font-size: 1rem;\r\n\r\n    }\r\n}\r\n\r\n.symptom-btn {\r\n    margin: 16px;\r\n\r\n    button {\r\n        margin-left: 1rem;\r\n        margin-bottom: 1rem;\r\n    }\r\n\r\n    .choicebtn {\r\n        color: #30abb3;\r\n        border-color: #30abb3;\r\n    }\r\n}\r\n\r\n.botton-btn {\r\n    position: fixed;\r\n    display: flex;\r\n    bottom: 0;\r\n    width: 100%;\r\n    background-color: white;\r\n    padding: 10px 16px;\r\n    justify-content: space-between;\r\n    box-sizing: border-box;\r\n\r\n\r\n    .nextbutton {\r\n        color: white;\r\n        background-color: #30abb3;\r\n        margin-left: 1rem;\r\n        font-size: 1.5rem;\r\n    }\r\n\r\n    .detailbutton {\r\n        color: #30abb3;\r\n        border-color: #30abb3;\r\n        font-size: 1.5rem;\r\n    }\r\n\r\n    button {\r\n        flex: auto\r\n    }\r\n}\r\n\r\n::v-deep .pet_typeClass {\r\n    text-align: center;\r\n    padding: 0 16px;\r\n    box-sizing: border-box;\r\n    display: flex;\r\n    flex-flow: column;\r\n\r\n    .top {\r\n        h2 {\r\n            text-align: center;\r\n        }\r\n    }\r\n\r\n    .choice {\r\n        flex-grow: 1;\r\n        height: 0;\r\n    }\r\n\r\n}\r\n\r\n.preview-nav {\r\n    text-align: left;\r\n    margin: 10px 0;\r\n}\r\n\r\n.preview-img {\r\n    vertical-align: top;\r\n    margin: 5px;\r\n    width: 6rem;\r\n    height: 6rem;\r\n    background-size: cover;\r\n    border-radius: 10px;\r\n}\r\n\r\n.cencelpreview {\r\n    position: fixed;\r\n    bottom: 20px;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}