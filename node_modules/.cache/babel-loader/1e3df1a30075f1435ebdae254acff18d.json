{"ast":null,"code":"import { inBrowser } from \"@vant/use\";\nconst hasIntersectionObserver = inBrowser && \"IntersectionObserver\" in window && \"IntersectionObserverEntry\" in window && \"intersectionRatio\" in window.IntersectionObserverEntry.prototype;\nconst modeType = {\n  event: \"event\",\n  observer: \"observer\"\n};\nfunction remove(arr, item) {\n  if (!arr.length) return;\n  const index = arr.indexOf(item);\n  if (index > -1) return arr.splice(index, 1);\n}\nfunction getBestSelectionFromSrcset(el, scale) {\n  if (el.tagName !== \"IMG\" || !el.getAttribute(\"data-srcset\")) return;\n  let options = el.getAttribute(\"data-srcset\");\n  const container = el.parentNode;\n  const containerWidth = container.offsetWidth * scale;\n  let spaceIndex;\n  let tmpSrc;\n  let tmpWidth;\n  options = options.trim().split(\",\");\n  const result = options.map(item => {\n    item = item.trim();\n    spaceIndex = item.lastIndexOf(\" \");\n    if (spaceIndex === -1) {\n      tmpSrc = item;\n      tmpWidth = 999998;\n    } else {\n      tmpSrc = item.substr(0, spaceIndex);\n      tmpWidth = parseInt(item.substr(spaceIndex + 1, item.length - spaceIndex - 2), 10);\n    }\n    return [tmpWidth, tmpSrc];\n  });\n  result.sort((a, b) => {\n    if (a[0] < b[0]) {\n      return 1;\n    }\n    if (a[0] > b[0]) {\n      return -1;\n    }\n    if (a[0] === b[0]) {\n      if (b[1].indexOf(\".webp\", b[1].length - 5) !== -1) {\n        return 1;\n      }\n      if (a[1].indexOf(\".webp\", a[1].length - 5) !== -1) {\n        return -1;\n      }\n    }\n    return 0;\n  });\n  let bestSelectedSrc = \"\";\n  let tmpOption;\n  for (let i = 0; i < result.length; i++) {\n    tmpOption = result[i];\n    bestSelectedSrc = tmpOption[1];\n    const next = result[i + 1];\n    if (next && next[0] < containerWidth) {\n      bestSelectedSrc = tmpOption[1];\n      break;\n    } else if (!next) {\n      bestSelectedSrc = tmpOption[1];\n      break;\n    }\n  }\n  return bestSelectedSrc;\n}\nconst getDPR = (scale = 1) => inBrowser ? window.devicePixelRatio || scale : scale;\nfunction supportWebp() {\n  if (!inBrowser) return false;\n  let support = true;\n  try {\n    const elem = document.createElement(\"canvas\");\n    if (elem.getContext && elem.getContext(\"2d\")) {\n      support = elem.toDataURL(\"image/webp\").indexOf(\"data:image/webp\") === 0;\n    }\n  } catch (err) {\n    support = false;\n  }\n  return support;\n}\nfunction throttle(action, delay) {\n  let timeout = null;\n  let lastRun = 0;\n  return function (...args) {\n    if (timeout) {\n      return;\n    }\n    const elapsed = Date.now() - lastRun;\n    const runCallback = () => {\n      lastRun = Date.now();\n      timeout = false;\n      action.apply(this, args);\n    };\n    if (elapsed >= delay) {\n      runCallback();\n    } else {\n      timeout = setTimeout(runCallback, delay);\n    }\n  };\n}\nfunction on(el, type, func) {\n  el.addEventListener(type, func, {\n    capture: false,\n    passive: true\n  });\n}\nfunction off(el, type, func) {\n  el.removeEventListener(type, func, false);\n}\nconst loadImageAsync = (item, resolve, reject) => {\n  const image = new Image();\n  if (!item || !item.src) {\n    return reject(new Error(\"image src is required\"));\n  }\n  image.src = item.src;\n  if (item.cors) {\n    image.crossOrigin = item.cors;\n  }\n  image.onload = () => resolve({\n    naturalHeight: image.naturalHeight,\n    naturalWidth: image.naturalWidth,\n    src: image.src\n  });\n  image.onerror = e => reject(e);\n};\nclass ImageCache {\n  constructor({\n    max\n  }) {\n    this.options = {\n      max: max || 100\n    };\n    this.caches = [];\n  }\n  has(key) {\n    return this.caches.indexOf(key) > -1;\n  }\n  add(key) {\n    if (this.has(key)) return;\n    this.caches.push(key);\n    if (this.caches.length > this.options.max) {\n      this.free();\n    }\n  }\n  free() {\n    this.caches.shift();\n  }\n}\nexport { ImageCache, getBestSelectionFromSrcset, getDPR, hasIntersectionObserver, loadImageAsync, modeType, off, on, remove, supportWebp, throttle };","map":{"version":3,"names":["inBrowser","hasIntersectionObserver","window","IntersectionObserverEntry","prototype","modeType","event","observer","remove","arr","item","length","index","indexOf","splice","getBestSelectionFromSrcset","el","scale","tagName","getAttribute","options","container","parentNode","containerWidth","offsetWidth","spaceIndex","tmpSrc","tmpWidth","trim","split","result","map","lastIndexOf","substr","parseInt","sort","a","b","bestSelectedSrc","tmpOption","i","next","getDPR","devicePixelRatio","supportWebp","support","elem","document","createElement","getContext","toDataURL","err","throttle","action","delay","timeout","lastRun","args","elapsed","Date","now","runCallback","apply","setTimeout","on","type","func","addEventListener","capture","passive","off","removeEventListener","loadImageAsync","resolve","reject","image","Image","src","Error","cors","crossOrigin","onload","naturalHeight","naturalWidth","onerror","e","ImageCache","constructor","max","caches","has","key","add","push","free","shift"],"sources":["C:/Users/yangp/Desktop/01-xiaoms/node_modules/vant/es/lazyload/vue-lazyload/util.mjs"],"sourcesContent":["import { inBrowser } from \"@vant/use\";\r\nconst hasIntersectionObserver = inBrowser && \"IntersectionObserver\" in window && \"IntersectionObserverEntry\" in window && \"intersectionRatio\" in window.IntersectionObserverEntry.prototype;\r\nconst modeType = {\r\n  event: \"event\",\r\n  observer: \"observer\"\r\n};\r\nfunction remove(arr, item) {\r\n  if (!arr.length)\r\n    return;\r\n  const index = arr.indexOf(item);\r\n  if (index > -1)\r\n    return arr.splice(index, 1);\r\n}\r\nfunction getBestSelectionFromSrcset(el, scale) {\r\n  if (el.tagName !== \"IMG\" || !el.getAttribute(\"data-srcset\"))\r\n    return;\r\n  let options = el.getAttribute(\"data-srcset\");\r\n  const container = el.parentNode;\r\n  const containerWidth = container.offsetWidth * scale;\r\n  let spaceIndex;\r\n  let tmpSrc;\r\n  let tmpWidth;\r\n  options = options.trim().split(\",\");\r\n  const result = options.map((item) => {\r\n    item = item.trim();\r\n    spaceIndex = item.lastIndexOf(\" \");\r\n    if (spaceIndex === -1) {\r\n      tmpSrc = item;\r\n      tmpWidth = 999998;\r\n    } else {\r\n      tmpSrc = item.substr(0, spaceIndex);\r\n      tmpWidth = parseInt(\r\n        item.substr(spaceIndex + 1, item.length - spaceIndex - 2),\r\n        10\r\n      );\r\n    }\r\n    return [tmpWidth, tmpSrc];\r\n  });\r\n  result.sort((a, b) => {\r\n    if (a[0] < b[0]) {\r\n      return 1;\r\n    }\r\n    if (a[0] > b[0]) {\r\n      return -1;\r\n    }\r\n    if (a[0] === b[0]) {\r\n      if (b[1].indexOf(\".webp\", b[1].length - 5) !== -1) {\r\n        return 1;\r\n      }\r\n      if (a[1].indexOf(\".webp\", a[1].length - 5) !== -1) {\r\n        return -1;\r\n      }\r\n    }\r\n    return 0;\r\n  });\r\n  let bestSelectedSrc = \"\";\r\n  let tmpOption;\r\n  for (let i = 0; i < result.length; i++) {\r\n    tmpOption = result[i];\r\n    bestSelectedSrc = tmpOption[1];\r\n    const next = result[i + 1];\r\n    if (next && next[0] < containerWidth) {\r\n      bestSelectedSrc = tmpOption[1];\r\n      break;\r\n    } else if (!next) {\r\n      bestSelectedSrc = tmpOption[1];\r\n      break;\r\n    }\r\n  }\r\n  return bestSelectedSrc;\r\n}\r\nconst getDPR = (scale = 1) => inBrowser ? window.devicePixelRatio || scale : scale;\r\nfunction supportWebp() {\r\n  if (!inBrowser)\r\n    return false;\r\n  let support = true;\r\n  try {\r\n    const elem = document.createElement(\"canvas\");\r\n    if (elem.getContext && elem.getContext(\"2d\")) {\r\n      support = elem.toDataURL(\"image/webp\").indexOf(\"data:image/webp\") === 0;\r\n    }\r\n  } catch (err) {\r\n    support = false;\r\n  }\r\n  return support;\r\n}\r\nfunction throttle(action, delay) {\r\n  let timeout = null;\r\n  let lastRun = 0;\r\n  return function(...args) {\r\n    if (timeout) {\r\n      return;\r\n    }\r\n    const elapsed = Date.now() - lastRun;\r\n    const runCallback = () => {\r\n      lastRun = Date.now();\r\n      timeout = false;\r\n      action.apply(this, args);\r\n    };\r\n    if (elapsed >= delay) {\r\n      runCallback();\r\n    } else {\r\n      timeout = setTimeout(runCallback, delay);\r\n    }\r\n  };\r\n}\r\nfunction on(el, type, func) {\r\n  el.addEventListener(type, func, {\r\n    capture: false,\r\n    passive: true\r\n  });\r\n}\r\nfunction off(el, type, func) {\r\n  el.removeEventListener(type, func, false);\r\n}\r\nconst loadImageAsync = (item, resolve, reject) => {\r\n  const image = new Image();\r\n  if (!item || !item.src) {\r\n    return reject(new Error(\"image src is required\"));\r\n  }\r\n  image.src = item.src;\r\n  if (item.cors) {\r\n    image.crossOrigin = item.cors;\r\n  }\r\n  image.onload = () => resolve({\r\n    naturalHeight: image.naturalHeight,\r\n    naturalWidth: image.naturalWidth,\r\n    src: image.src\r\n  });\r\n  image.onerror = (e) => reject(e);\r\n};\r\nclass ImageCache {\r\n  constructor({ max }) {\r\n    this.options = {\r\n      max: max || 100\r\n    };\r\n    this.caches = [];\r\n  }\r\n  has(key) {\r\n    return this.caches.indexOf(key) > -1;\r\n  }\r\n  add(key) {\r\n    if (this.has(key))\r\n      return;\r\n    this.caches.push(key);\r\n    if (this.caches.length > this.options.max) {\r\n      this.free();\r\n    }\r\n  }\r\n  free() {\r\n    this.caches.shift();\r\n  }\r\n}\r\nexport {\r\n  ImageCache,\r\n  getBestSelectionFromSrcset,\r\n  getDPR,\r\n  hasIntersectionObserver,\r\n  loadImageAsync,\r\n  modeType,\r\n  off,\r\n  on,\r\n  remove,\r\n  supportWebp,\r\n  throttle\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}